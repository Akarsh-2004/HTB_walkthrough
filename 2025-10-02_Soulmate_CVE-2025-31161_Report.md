# Soulmate — HTB Walkthrough & Notes (Exploit Repo README)

**Repository purpose:** This repo contains documentation and notes used during an *authorized* HTB lab engagement against the `ftp.soulmate.htb` machine (Soulmate). It describes the vulnerability (CVE-2025-31161), safe PoC invocation metadata, and a high-level, non-weaponized walkthrough of initial access and post‑exploitation steps performed for learning and report purposes.

> ⚠️ **Disclaimer / Legal:** All material in this repository is for **authorized penetration testing, education, and defensive research only**. Do **not** use these techniques outside of legal scope (e.g., production systems without explicit permission). If you discover a true zero‑day on a production system, follow responsible disclosure procedures — do not weaponize or publish exploit code.

---

## Table of contents

* [Overview](#overview)
* [CVE & Affected Version](#cve--affected-version)
* [Safe PoC Usage (authorized labs only)](#safe-poc-usage-authorized-labs-only)
* [Post‑Exploit Summary (high level)](#post-exploit-summary-high-level)
* [Repro / Quick Checklist](#repro--quick-checklist)
* [Remediation & Mitigations](#remediation--mitigations)
* [References](#references)
* [Author](#author)

---

## Overview

Soulmate (ftp.soulmate.htb) was compromised in an HTB lab by abusing an authentication bypass in the CrushFTP web interface. The bypass allowed creation of application users without proper authentication, enabling further actions in the web UI (user management, file upload) that led to initial code execution and eventual privilege escalation.

This README documents the high‑level steps taken and recommended mitigations. It does not include weaponized exploit payloads.

---

## CVE & affected version

* **CVE:** CVE-2025-31161
* **Affected software:** CrushFTP
* **Identified version on target:** `11.W.657` (build date visible in asset query strings)
* **Issue summary:** Authentication bypass allowing unauthorized creation of application users and subsequent application-level access.

---

## Safe PoC usage (authorized labs only)

A public proof‑of‑concept repository was used during the lab to automate account creation. Use these steps **only** within authorized test labs.

```bash
# clone PoC (example public repo used in lab)
git clone https://github.com/Immersive-Labs-Sec/CVE-2025-31161
cd CVE-2025-31161

# Example invocation (HTB/lab only) — adjust host/port as required:
python cve-2025-31161.py --target_host ftp.soulmate.htb --port 80 \
    --target_user root --new_user test --password admin123
```

**Expected output (authorized lab):**

```
[+] User created successfully
[+] You can now login with:
    Username: test
    Password: admin123
```

> Do **not** paste exploit payloads or large sections of exploit code into public channels. Use PoCs for verification only and keep logs for a responsible disclosure/report.

---

## Post‑Exploit summary (high level)

> This section summarizes the actions performed after obtaining application access. It purposefully omits low-level exploit payloads.

1. Log in to CrushFTP web UI with newly created account (e.g., `test:admin123`).
2. Navigate to Admin → User Manager and change password for an existing user (`ben`).
3. Log in as `ben` and use the web UI's upload functionality to place a web shell (uploaded to a web‑accessible directory).
4. Trigger uploaded web shell to obtain a reverse shell as the web user (e.g., `www-data`).
5. Enumerate the host (LinPEAS or manual enumeration) and discover an Erlang-based service and a root-run script containing hardcoded credentials.
6. Use the discovered credentials to SSH into the box and/or connect to the Erlang SSH runner on an internal port (2222), which exposes an Erlang shell running as root.
7. Execute commands from the Erlang shell (e.g., `os:cmd/1`) to read `root.txt`.

**Flags captured (lab):**

* `user.txt` — `81b8219692204e627f7e41a11e42b26b`
* `root.txt` — `80461dd19af5e549e5b73211e1a2c8c9`

---

## Repro / Quick checklist for reports

1. Enumerate web assets and identify version (check `?v=` tokens in scripts/styles).
2. Search vendor advisories / public CVE databases for that version.
3. Use authorized PoC to verify the issue; log and capture the HTTP responses.
4. After account creation, verify login via UI; document UI steps with screenshots for your HTB writeup.
5. If file upload is available, validate allowed file types and whether uploads are served from webroot.
6. After execution, perform safe enumeration (LinPEAS, netstat, ps, file checks).
7. Document any plaintext credentials, listening services, and misuse of root privileges.
8. Capture flags (if HTB) and prepare a full technical report including remediation.

---

## Remediation & mitigations

* **Apply vendor patch** for CVE-2025-31161 or upgrade CrushFTP to a fixed release.
* **Harden admin endpoints**: restrict account creation and admin functions behind strong authentication and MFA.
* **Sanitize uploads**: disallow executable scripts in upload directories or store uploads outside the webroot; implement server-side validation.
* **Eliminate plaintext secrets** from scripts and config files; use secret managers and strict file permissions.
* **Network separation**: internal services (like Erlang runners) should be bound to localhost or internal networks and require strong auth.
* **Run services with least privilege**; avoid running services or shells as root where possible.
* **Monitoring & alerting** for anomalous user creation, mass uploads, or unexpected process activity.

---

## References

* CVE-2025-31161 (public advisories / PoC)
* Pentestmonkey — PHP reverse shell (for lab use)
* Erlang/Elixir command-execution writeups (security research)

---

## Author

Akarsh Saklani — notes produced during an authorized HTB lab (2025-10-02). Contact: [akarshsaklani222@gmail.com](mailto:akarshsaklani222@gmail.com)

---

If you want, I can:

* generate a polished `README.md` file in the repository (I can create it for you),
* include example `nmap`/`curl` outputs and sanitized screenshots, or
* convert this README into a longer `REPORT.md` with images and step-by-step screenshots for HTB writeups.

Which would you like next?
